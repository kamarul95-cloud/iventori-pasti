<div id="add-product-view">
    <h2>➕ Tambah Produk Baharu</h2>
    <p>Data akan dihantar ke Apps Script API anda untuk disimpan ke Google Sheet.</p>
    
    <form id="addProductForm" onsubmit="handleFormSubmit(event)">
        
        <label for="sku">SKU:</label>
        <input type="text" id="sku" name="sku" required><br><br>
        
        <label for="name">Nama Produk:</label>
        <input type="text" id="name" name="name" required><br><br>
        
        <label for="quantity">Kuantiti:</label>
        <input type="number" id="quantity" name="quantity" required><br><br>
        
        <label for="cost">Harga Belian (RM):</label>
        <input type="number" step="0.01" id="cost" name="cost" required><br><br>
        
        <label for="price">Harga Jualan (RM):</label>
        <input type="number" step="0.01" id="price" name="price" required><br><br>
        
        <button type="submit" style="background-color: #2ecc71; color: white; border: none; padding: 10px 15px; cursor: pointer; border-radius: 4px;">Simpan Produk</button>
        <div id="form-status" style="margin-top: 15px;"></div>
    </form>
</div>

<script>
    // URL API Apps Script anda (untuk fungsi MENULIS)
    const GAS_WRITE_API_URL = 'https://script.google.com/macros/s/AKfycbwg336ZLa1EAyETMU5_X6cY9huwelGJNObhEBVQOUoRP-S4E7WTrkXlmE86Rd69VXGt/exec';

    async function handleFormSubmit(event) {
        event.preventDefault(); 
        
        const form = document.getElementById('addProductForm');
        const statusDiv = document.getElementById('form-status');
        
        const productData = {
            sku: form.sku.value,
            name: form.name.value,
            quantity: parseInt(form.quantity.value),
            cost: parseFloat(form.cost.value),
            price: parseFloat(form.price.value)
        };

        statusDiv.innerHTML = 'Menyimpan data ke Apps Script...';
        
        try {
            // Menggunakan Fetch POST untuk menghantar data ke fungsi doPost di Code.gs
            const response = await fetch(GAS_WRITE_API_URL, {
                method: 'POST',
                mode: 'cors', // Penting untuk CORS/GitHub
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(productData)
            });

            if (!response.ok) {
                 throw new Error(`Ralat API! Status: ${response.status}`);
            }

            const result = await response.json();

            statusDiv.innerHTML = `<span style="color: green; font-weight: bold;">✅ ${result.message}</span>`;
            form.reset();

        } catch (error) {
            statusDiv.innerHTML = `<span style="color: red; font-weight: bold;">❌ Ralat API: ${error.message}</span>`;
            console.error("Ralat simpan:", error);
        }
    }
    
    function initializeAddProductForm() {
        console.log("Modul AddProduct diaktifkan.");
    }
</script>

<style>
/* ... CSS dari kod asal anda ... */
#addProductForm label { display: inline-block; width: 150px; text-align: right; margin-right: 10px; }
#addProductForm input[type="text"], #addProductForm input[type="number"] { padding: 8px; margin-bottom: 10px; width: 250px; border: 1px solid #ccc; border-radius: 4px; }
</style>
