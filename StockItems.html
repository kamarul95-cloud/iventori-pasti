<div id="stock-items-view">
Â  <h2>ðŸ“¦ Senarai Stok Produk</h2>
Â  <button onclick="loadContent('AddProduct')" style="float: right; margin-bottom: 10px; background-color: #2ecc71; color: white; border: none; padding: 10px 15px; cursor: pointer; border-radius: 4px;">+ Tambah Produk</button>
Â Â 
Â  <div id="product-table-container">
Â  Â  <p>Memuatkan data inventori...</p>
Â  </div>
</div>

<script>
Â  const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTgoIbqldOdwiW1qXp_m_iECMPaxxAnyLG7knRJqiImBeId945SYpwxeJPRPnEDK4gVHXMZ9oFgW8Tj/pub?gid=0&single=true&output=csv';

  // Fungsi pemuat data telah diubah untuk menggunakan PapaParse
Â  function loadStockData() {
    const container = document.getElementById('product-table-container');
    container.innerHTML = `<p>Memuatkan data inventori melalui PapaParse...</p>`;

    // PapaParse akan memuat turun (fetch) dan parse data
    Papa.parse(CSV_URL, {
      download: true,
      header: false, // Kita masih mahu array 2D, bukan array of objects
      skipEmptyLines: true,
      complete: function(results) {
        let data = results.data;
        
        // Buang baris header pertama
        if (data.length > 0) {
            data.shift();
        }

        displayProducts(data);
      },
      error: function(error) {
        container.innerHTML = `<p style="color: red;">Ralat PapaParse: Gagal memuatkan data. ${error.message}</p>`;
      }
    });
Â  }

Â  function displayProducts(data) {
Â  Â  const container = document.getElementById('product-table-container');
    if (!data || data.length === 0) {
        container.innerHTML = `<p style="color: red;">Tiada data produk ditemui.</p>`;
        return;
    }
Â  Â  
Â  Â  const headers = ['SKU', 'Nama Produk', 'Kuantiti', 'Harga Belian', 'Harga Jualan', 'Tindakan'];
Â  Â  let html = '<table><thead><tr>';
Â  Â  headers.forEach(h => html += `<th>${h}</th>`);
Â  Â  html += '</tr></thead><tbody>';

Â  Â  data.forEach(row => {
      // Pastikan array baris mempunyai sekurang-kurangnya 5 elemen untuk elak ralat index
      if (row.length < 5) return; 

Â  Â  Â  const productSku = row[0] ? row[0].toString().trim() : '';Â 
Â  Â  Â  const currentQuantity = parseInt(row[2]) || 0;Â 
Â  Â  Â  const rowClass = currentQuantity < 10 ? 'low-stock' : '';Â 
Â  Â  Â Â 
Â  Â  Â  html += `<tr class="${rowClass}">`;
Â  Â  Â  row.forEach(cell => html += `<td>${cell !== null && cell !== undefined ? cell : ''}</td>`);
Â  Â  Â Â 
Â  Â  Â  const skuString = JSON.stringify(productSku);
Â  Â  Â Â 
Â  Â  Â  html += `<td>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="editItem(${skuString})" class="btn-action edit">Edit</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="deleteItem(${skuString})" class="btn-action delete">Hapus</button>
Â  Â  Â  Â  Â  Â  Â  </td>`;
Â  Â  Â  html += '</tr>';
Â  Â  });

Â  Â  html += '</tbody></table>';
Â  Â  container.innerHTML = html;Â 
Â  }
Â Â 
Â  // Fungsi edit/delete placeholder
Â  function editItem(sku) { console.log('Edit item:', sku); alert('Edit ' + sku + ' belum berfungsi lagi.'); }
Â  function deleteItem(sku) { console.log('Hapus item:', sku); alert('Hapus ' + sku + ' belum berfungsi lagi.'); }

</script>

<style>
/* CSS Stok anda dikekalkan */
#stock-items-view table { width: 100%; border-collapse: collapse; margin-top: 10px; }
#stock-items-view th, #stock-items-view td { border: 1px solid #ccc; padding: 10px; text-align: left; }
#stock-items-view th { background-color: #ecf0f1; }
#stock-items-view .low-stock { background-color: #fce7e7; color: #c0392b; font-weight: bold; }
.btn-action { padding: 5px 10px; margin-right: 5px; border: none; cursor: pointer; border-radius: 3px;}
.btn-action.edit { background-color: #3498db; color: white; }
.btn-action.delete { background-color: #e74c3c; color: white; }
</style>
